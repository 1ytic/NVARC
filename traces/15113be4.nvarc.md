<rules_summary>
Rows and columns containing only '4's remain unchanged; other rows and columns have a color replacement pattern affecting only some cells and dependent on relative position to '4' boundaries. The specific replacement rule is: 1 becomes 6 and 0 becomes 3, or vice versa in some cases, near the bottom of the grid.
</rules_summary>
<input_generation>
Input grids of varying sizes are provided. The transformation maintains relationships between input and output dimensions.
</input_generation>
<solution_steps>
1. Identify rows and columns containing only '4's and leave these unchanged.
2. For other rows and columns, apply color mapping: 1 -> 6, 0 -> 3, vice versa near the bottom, preserving other values.
3. Construct output grid.
</solution_steps>
<key_insight>
Input and output grids have the same dimensions.
</key_insight>
<puzzle_concepts>
- color_mapping
- connected
- tiling
</puzzle_concepts>
